# Stratum åè®®æµ‹è¯•æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•ä½¿ç”¨ CGMiner-RS é¡¹ç›®ä¸­çš„ Stratum åè®®æµ‹è¯•å·¥å…·æ¥éªŒè¯çŸ¿æ± è¿æ¥å’Œåè®®å…¼å®¹æ€§ã€‚

## Stratum åè®®ç®€ä»‹

### ä»€ä¹ˆæ˜¯ Stratum åè®®ï¼Ÿ

Stratum æ˜¯ä¸“ä¸ºçŸ¿æ± æŒ–çŸ¿è®¾è®¡çš„åè®®ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **ä½å»¶è¿Ÿ**: æœ€å°åŒ–ç½‘ç»œé€šä¿¡å»¶è¿Ÿ
- **é«˜æ•ˆç‡**: å‡å°‘ç½‘ç»œå¸¦å®½ä½¿ç”¨
- **å¯æ‰©å±•**: æ”¯æŒå„ç§ç®—åŠ›çš„ç¡¬ä»¶
- **å®æ—¶æ€§**: å¿«é€Ÿè·å–æ–°å·¥ä½œï¼Œå‡å°‘æ‹’ç»ç‡

### URL æ ¼å¼

æ­£ç¡®çš„ Stratum URL æ ¼å¼ï¼š
```
stratum+tcp://æœåŠ¡å™¨åœ°å€:ç«¯å£
```

ç¤ºä¾‹ï¼š
- `stratum+tcp://btc.f2pool.com:1314` - F2Pool BTC çŸ¿æ± 
- `stratum+tcp://192.168.18.240:10203` - æœ¬åœ°æˆ–å†…ç½‘çŸ¿æ± 
- `stratum+tcp://pool.example.com:4444` - é€šç”¨çŸ¿æ± 

## æµ‹è¯•å·¥å…·ä½¿ç”¨

### ç¼–è¯‘æµ‹è¯•å·¥å…·

```bash
# ç¼–è¯‘æ‰€æœ‰äºŒè¿›åˆ¶ç¨‹åº
cargo build --release

# æˆ–è€…åªç¼–è¯‘æµ‹è¯•å·¥å…·
cargo build --release --bin test-stratum-connection
```

### åŸºæœ¬ä½¿ç”¨

```bash
# æµ‹è¯•é»˜è®¤åœ°å€ (192.168.18.240:10203)
cargo run --bin test-stratum-connection

# æµ‹è¯•æŒ‡å®šåœ°å€
cargo run --bin test-stratum-connection -- --url "stratum+tcp://192.168.18.240:10203"

# ä½¿ç”¨è‡ªå®šä¹‰ç”¨æˆ·åå’Œå¯†ç 
cargo run --bin test-stratum-connection -- \
  --url "stratum+tcp://192.168.18.240:10203" \
  --username "test.worker" \
  --password "x"

# æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
cargo run --bin test-stratum-connection -- \
  --url "stratum+tcp://192.168.18.240:10203" \
  --verbose

# è®¾ç½®è¿æ¥è¶…æ—¶
cargo run --bin test-stratum-connection -- \
  --url "stratum+tcp://192.168.18.240:10203" \
  --timeout 30
```

### å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | çŸ­å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|--------|------|
| `--url` | `-u` | `stratum+tcp://192.168.18.240:10203` | Stratum æœåŠ¡å™¨ URL |
| `--username` | `-u` | `test.worker` | æµ‹è¯•ç”¨æˆ·å |
| `--password` | `-p` | `x` | æµ‹è¯•å¯†ç  |
| `--timeout` | `-t` | `10` | è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| `--verbose` | `-v` | `false` | æ˜¾ç¤ºè¯¦ç»†è¾“å‡º |

## æµ‹è¯•æµç¨‹

æµ‹è¯•å·¥å…·æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

### 1. URL éªŒè¯
- æ£€æŸ¥ URL æ˜¯å¦ä»¥ `stratum+tcp://` å¼€å¤´
- è§£ææœåŠ¡å™¨åœ°å€å’Œç«¯å£

### 2. TCP è¿æ¥æµ‹è¯•
- å°è¯•å»ºç«‹ TCP è¿æ¥
- éªŒè¯ç½‘ç»œè¿é€šæ€§
- æ˜¾ç¤ºè¿æ¥ä¿¡æ¯ï¼ˆå¦‚æœå¯ç”¨è¯¦ç»†è¾“å‡ºï¼‰

### 3. Stratum åè®®æµ‹è¯•
- å‘é€ `mining.subscribe` è¯·æ±‚
- è§£ææœåŠ¡å™¨å“åº”
- å‘é€ `mining.authorize` è¯·æ±‚
- åˆ†æè®¤è¯ç»“æœ

### 4. çŸ¿æ± è¯†åˆ«
- åˆ†æå“åº”å†…å®¹
- å°è¯•è¯†åˆ«çŸ¿æ± ç±»å‹
- æ£€æµ‹ F2Pool ç‰¹å¾

## è¾“å‡ºè§£é‡Š

### æˆåŠŸè¾“å‡ºç¤ºä¾‹

```
ğŸ” Stratum åè®®æµ‹è¯•å·¥å…·
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ æµ‹è¯•é…ç½®:
   URL: stratum+tcp://192.168.18.240:10203
   ç”¨æˆ·å: test.worker
   å¯†ç : x
   è¶…æ—¶: 10 ç§’

ğŸ”— æ­£åœ¨è¿æ¥åˆ°: 192.168.18.240:10203
âœ… TCP è¿æ¥æˆåŠŸ
âœ… Stratum åè®®æµ‹è¯•æˆåŠŸ
ğŸ“Š çŸ¿æ± ä¿¡æ¯:
   æ”¯æŒæ–¹æ³•: mining.notify, è®¤è¯æˆåŠŸ, ğŸŸ æ£€æµ‹åˆ° F2Pool çŸ¿æ± ç‰¹å¾

ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆï¼
```

### é”™è¯¯è¾“å‡ºç¤ºä¾‹

```
âŒ TCP è¿æ¥å¤±è´¥: Connection refused (os error 61)
```

```
âŒ Stratum åè®®æµ‹è¯•å¤±è´¥: æœåŠ¡å™¨å“åº”ä¸ç¬¦åˆ Stratum åè®®æ ¼å¼
```

## å¸¸è§é—®é¢˜æ’æŸ¥

### è¿æ¥è¢«æ‹’ç»
- æ£€æŸ¥æœåŠ¡å™¨åœ°å€å’Œç«¯å£æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æœåŠ¡å™¨æ˜¯å¦åœ¨è¿è¡Œ
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### åè®®ä¸å…¼å®¹
- ç¡®è®¤æœåŠ¡å™¨æ”¯æŒ Stratum åè®®
- æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦ä¸º HTTP è€Œé Stratum
- éªŒè¯æœåŠ¡å™¨é…ç½®

### è®¤è¯å¤±è´¥
- æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
- ç¡®è®¤çŸ¿æ± æ˜¯å¦éœ€è¦æ³¨å†Œ
- éªŒè¯çŸ¿å·¥åç§°æ ¼å¼

## F2Pool ç‰¹å¾æ£€æµ‹

æµ‹è¯•å·¥å…·ä¼šå°è¯•æ£€æµ‹ä»¥ä¸‹ F2Pool ç‰¹å¾ï¼š
- å“åº”ä¸­åŒ…å« "f2pool" æˆ– "F2Pool" å­—ç¬¦ä¸²
- ç‰¹å®šçš„è®¢é˜…å“åº”æ ¼å¼
- F2Pool ç‰¹æœ‰çš„æ–¹æ³•æ”¯æŒ

## é›†æˆåˆ°é…ç½®æ–‡ä»¶

æµ‹è¯•æˆåŠŸåï¼Œå¯ä»¥å°†åœ°å€æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ï¼š

```toml
[[pools.pools]]
url = "stratum+tcp://192.168.18.240:10203"
user = "your_username.worker"
password = "your_password"
priority = 1
enabled = true
```

## é«˜çº§ç”¨æ³•

### æ‰¹é‡æµ‹è¯•å¤šä¸ªåœ°å€

åˆ›å»ºè„šæœ¬æµ‹è¯•å¤šä¸ªçŸ¿æ± ï¼š

```bash
#!/bin/bash

pools=(
    "stratum+tcp://192.168.18.240:10203"
    "stratum+tcp://btc.f2pool.com:1314"
    "stratum+tcp://btc-asia.f2pool.com:1314"
)

for pool in "${pools[@]}"; do
    echo "æµ‹è¯•çŸ¿æ± : $pool"
    cargo run --bin test-stratum-connection -- --url "$pool"
    echo "---"
done
```

### æ€§èƒ½æµ‹è¯•

ä½¿ç”¨ `time` å‘½ä»¤æµ‹è¯•è¿æ¥æ€§èƒ½ï¼š

```bash
time cargo run --release --bin test-stratum-connection -- \
  --url "stratum+tcp://192.168.18.240:10203"
```

## æ•…éšœæ’é™¤

å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š

1. **ç½‘ç»œè¿æ¥**: ç¡®ä¿èƒ½å¤Ÿè®¿é—®ç›®æ ‡æœåŠ¡å™¨
2. **ç«¯å£å¼€æ”¾**: ç¡®è®¤ç›®æ ‡ç«¯å£æœªè¢«é˜²ç«å¢™é˜»æ­¢
3. **åè®®æ”¯æŒ**: ç¡®è®¤æœåŠ¡å™¨æ”¯æŒ Stratum åè®®
4. **æœåŠ¡çŠ¶æ€**: ç¡®è®¤çŸ¿æ± æœåŠ¡æ­£åœ¨è¿è¡Œ

## ç›¸å…³æ–‡æ¡£

- [é…ç½®æ–‡ä»¶è¯´æ˜](configuration.md)
- [çŸ¿æ± é…ç½®æŒ‡å—](pool-configuration.md)
- [ç½‘ç»œæ•…éšœæ’é™¤](network-troubleshooting.md)
